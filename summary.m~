
cd(stat_dir);
if BP1 > 0
    dataAll = [num2cell(data), data2, num2cell(dataB)];
    dataTitle = {'Nucleus', 'Area', 'DAPI intensity', 'gH2AX intensity', 'gH2AX periphery/center',...
        'gH2AX homogeneity', 'Signal class', '53BP1 intensity', 'gH2AX/53BP1 correlation', 'p-value'};
    dataAll = [dataTitle; dataAll];
    cell2csv([num2str(loop),'.csv'], dataAll);
    imnumber = ones(size(dataAll,1)-1,1)*loop;
    imnumber = [num2cell(imnumber), dataAll(2:end,:)];
    datapulled = [datapulled; imnumber];
    avdata(loop, 1) = loop;     %number of image
    avdata(loop, 2) = numel(B); %number of nuclei in image
    avdata(loop, 3) = mean(data(:,2)); % average area
    avdata(loop, 4) = std(data(:,2)); % SD area
    avdata(loop, 5) = mean(data(:,3)); % average DAPI intensity
    avdata(loop, 6) = std(data(:,3)); % SD DAPI intensity
    avdata(loop, 7) = mean(data(:,4)); % average gH2AX intensity
    avdata(loop, 8) = std(data(:,4)); % SD gH2AX intensity
    avdata(loop, 9) = mean(dataB(:,1)); % average 53BP1 intensity
    avdata(loop, 10) = std(dataB(:,1)); % SD 53BP1 intensity
    avdata(loop, 11) = mean(dataB(:,2)); % average correlation
    avdata(loop, 12) = std(dataB(:,2)); % SD correlation
    idx = strfind(data2, 'ring');
contains
    idx = find(cellfun('isempty', idx));
    avdata(loop, 13) =
else
    dataAll = [num2cell(data), data2];
    dataTitle = {'Nucleus', 'Area', 'DAPI intensity', 'gH2AX intensity', 'gH2AX periphery/center',...
        'gH2AX homogeneity', 'Signal class'};
    dataAll = [dataTitle; dataAll];
    cell2csv([num2str(loop),'.csv'], dataAll);
    imnumber = ones(size(dataAll,1)-1,1)*loop;
    imnumber = [num2cell(imnumber), dataAll(2:end,:)];
    datapulled = [datapulled; imnumber];
end
cd(filedir);